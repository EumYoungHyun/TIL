## SWR (Stale-While-Revalidate)

## 노마드 개념

HTTP 캐시 무효화 전략

scenario
홈 화면에서 유저 정보를 fetching하는 서비스가 있다.
이 페이지에서 유저가 홈에 들어가면 유저정보 fetching을 통해 유저에 대한 정보를 받는다.
그 유저가 다른 페이지에 갔다가 다시 홈으로 돌아갈때 SWR을 이용하면 다시 요청하지 않고 기존의 데이터를 캐시에서 가져와서 보여준다

그렇다면 클라이언트 입장에서는 홈 화면에서 다시 로딩을 볼 필요가 없고,
SWR은 뒷단에서 API요청을 통해 데이터 내용이 변경되었는지 체크한다.
만약 데이터가 바뀌었다면 데이터를 업데이트 하고 그렇지 않다면 이전의 화면을 그대로 보여준다.

```
// 나머지 채우기
```

## SWR 공식문서

Next.js를 개발한 zeit에서 SWR을 활용하는 훅 useSWR을 제작함

SWR은 [HTTP RFC 5861]에 의해 알려진 HTTP 캐시 무효 전략인 Stale-While-Revalidate에서 유래되었다.
SWR은 먼저 캐시(Stale)로부터 데이터를 변환한 후, fetch 요청(재검증)을 하고, 최종적으로 최신화된 데이터를 가져오는 전략이다.

SWR을 사용하면 컴포넌트는 지속적이며 자동으로 데이터 업데이트 스트림을 받게 된다.
그리고 UI는 항상 빠르게 반응한다.

```jsx
import useSWR from "swr";

function Profile() {
  const { data, error } = useSWR("/api/user", fetcher);

  if (error) return <div>failed to load</div>;
  if (!data) return <div>loading...</div>;
  return <div>hello {data.name}!</div>;
}

이 예시에서, `useSWR` hook은 `key`문자열과 `fetcher` 함수를 받습니다. `key`는 데이터의 고유한 식별자이며 (일반적으로 API URL) `fetcher`로 전달될 것입니다.
`fetcher`은 데이터를 반환하는 어떠한 비동기 함수도 될 수 있습니다. 네이티브 fetch 또는 Axios와 같은 도구를 사용할 수 있습니다.

hook은 요청상태에 따라 `data`와 `error` 두 개의 값을 반환합니다.

useSWR을 이용해 단 한 줄의 코드로 데이터를 가져오는 로직을 단순화 할 수 있으며, 그 외에도 다양한 기능들을 제공합니다.

- 빠르고 가볍고, 재사용 가능한 데이터 가져오기
- 내장된 캐시 및 중복 요청 제거
- 실시간 호출
- 전송 및 프로토콜에 구애받지 않음
- SSR / ISR / SSG 지원
- Typescript 준비
- React Native 호환

또한 SWR은 더 나은 UX, DX를 위해 속도, 정확성, 안정성의 모든 측면을 다룹니다.

- 빠른 페이지 네비게이션
- 인터벌 폴링
- 데이터 의존성
- 포커스시 재검증
- 네트워크 회복시 재검증
- 로컬 뮤테이션(Optimistic UI)
- 스마트한 여러 재시도
- 페이지 및 스크롤 위치 복구
- React Suspence

그 외에 더 많은 내용 확인이 필요하면 공홈 ㄱ

```

참고 - https://swr.vercel.app/ko

## 정보 1 개념

SWR은 데이터를 가져오기 위한 React의 hook이다.
Next.js를 개발한 zeit그룹에서 제작한 라이브러리이다.

```
// 나머지 채우기
```

참고 - https://velog.io/@soryeongk/SWRBasic

## 정보 2 개념

개발자들은 React Application에서 데이터를 저장하기 위해 state를 활용한다.
앱이 새로 로딩될때는 state들이 비어있는 상태로 리턴되며, 대부분의 경우 `uesEffect`나 `componentDidMount`과정을 거치며 외부 소스에서 검색하고 가져오는 과정을 반복해서 수행한다.
하지만 모든 순간 클라이언트 측의 빠른 대응을 기대할 순 없다. 데이터 충돌이나 클라이언트 측의 네트워크의 상태가 느려지는 경우 앱은 데이터가 없는 빈 페이지를 반환하게 된다.

운좋게도 state처리 전에 캐시 데이터를 검색하는 2개의 라이브러리 React Query와 SWR이 있다. 이 두가지를 간단하게 비교해보자.

이 튜토리얼을 이해하기 위해 React Query, React, JS, React Suspense 및 jsx를 이해하고 있어야 한다.

### SWR이란 무엇인가.

SWR이란 Stail-While-Revalidate의 약자이다. Vercel(=ZEIT)사에서 제작된 리액트 훅 라이브러리로서

1. 외부 API로부터 데이터를 검색하고
2. 캐시에 데이터를 저장하며
3. 데이터를 렌더링한다.
   이 글을 통해 서스펜스 모드와 데이터 패칭에 대해 살펴보자
   <br/>

---

swr은 아래의 명령어를 통해 설치한다.

```
npm i swr

yarn add swr
```

SWR의 useSWR은 fetcher함수를 통해 비동기적으로 URL에서 데이터를 검색하는 훅이다. URL과 fetcher는 useSWR의 인자로 들어간다.

```javascript
useSWR(key, fetcher, options);
```

key인자는 문자열 형태의 URL이다.  
fetcher함수는 전역적으로 선언되어있거나  
미리 선언된 커스텀 함수이거나  
useSWR 인자로 선언된 익명함수이다.

useSWR은 기본적으로 받은 데이터, request 상태 검증, 상태 재인증 변수와 에러가 있다면 에러까지 반환한다.

```javascript
const { data, isValidating, revalidate, error } = useSWR(key, fetcher);
```

<br />
참고 - https://blog.logrocket.com/useswr-vs-react-query/

[http rfc 5861]: https://datatracker.ietf.org/doc/html/rfc5861
